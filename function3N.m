function F = function3N(x)
global C0 C1 h Mgiven d

F(1) = d.*((C1*(x(2) - h/2).^2)/2 + (x(2) - h/2).*(C0 - C1.*x(2)) + (d.*x(1)*(C0 - C1.*x(2)).^2)./(C0 - C1*x(2) + C1*x(1)*(d + 1)) - (C1.*d^2*x(1).^2.*(C0 - C1*x(2)).^2)./(2*(C0 - C1.*x(2) + C1.*x(1).*(d + 1)).^2)) + (x(1).*(C0 - C1.*(x(2) - x(1))))./2 + ((2.*x(2) + h - 2.*x(1)).*(4*C0 - 2*C1.*x(2) + C1*h + 2*C1*x(1)))/8 - (d.^2.*x(1)*(C0 - C1*x(2)).^2*(C0 - C1*(x(2) - x(1))))./(2*(C0 - C1*x(2) + C1*x(1)*(d + 1)).^2)
F(2) = (C0/2 - (C1*x(2))./2).*(x(2) + h/2).^2 - x(1).^2.*(C0/2 - (C1.*x(2))/2) - (C1.*x(1).^3)/3 + (C1.*(x(2) + h/2).^3)/3 + d.*((C0/2 - (C1.*x(2))/2).*(x(2) - h/2).^2 + (C1.*(x(2) - h/2).^3)./3 + (C1.*d.^3*x(1).^3.*(C0 - C1*x(2)).^3)/(3*(C0 - C1.*x(2) + C1*x(1)*(d + 1)).^3) - (d^2*x(1).^2*(C0/2 - (C1.*x(2))./2).*(C0 - C1.*x(2)).^2)/(C0 - C1.*x(2) + C1*x(1).*(d + 1)).^2) + (x(1)^2*(C0 - C1.*(x(2) - x(1))))./3 + (d.^3*x(1).^2*(C0 - C1*x(2)).^3.*(C0 - C1.*(x(2)- x(1))))./(3.*(C0 - C1.*x(2) + C1.*x(1)*(d + 1)).^3)- Mgiven
end

